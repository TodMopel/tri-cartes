{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import axios from'axios';import Papa from'papaparse';import'./../App.css';import config from'./../data/config';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const HomePage=_ref=>{let{onGoogleSheetSubmit,onStartGameSubmit}=_ref;const[googleSheetURL,setGoogleSheetURL]=useState(config.home.baseURL);const[extractionCount,setExtractionCount]=useState(null);const[errorMessages,setErrorMessages]=useState([]);const[localStorageDetected,setLocalStorageDetected]=useState(false);useEffect(()=>{const isLocalStorageDetected=localStorage.getItem('gameState');setLocalStorageDetected(!!isLocalStorageDetected);fetchGoogleSheetData();},[]);const handleURLChange=event=>{setGoogleSheetURL(event.target.value);};useEffect(()=>{fetchGoogleSheetData();},[]);const fetchGoogleSheetData=async()=>{try{const response=await axios.get(googleSheetURL);const csvData=response.data;Papa.parse(csvData,{header:true,dynamicTyping:true,complete:result=>{const activeJobs=result.data.filter(row=>row.ACTIF===true);const formattedData=activeJobs.map(row=>({text:row.MÉTIER,description:row.DESCRIPTION}));setExtractionCount(activeJobs.length);setErrorMessages([]);onGoogleSheetSubmit(formattedData);},error:error=>{console.error('Erreur lors de l\\'analyse CSV :',error);setExtractionCount(null);setErrorMessages([error.message]);}});}catch(error){console.error('Erreur lors de la récupération des données du Google Sheet :',error);setExtractionCount(null);setErrorMessages([\"Erreur lors de la r\\xE9cup\\xE9ration des donn\\xE9es du Google Sheet:\\n \".concat(error)]);}};const handleSubmit=()=>{setExtractionCount(null);fetchGoogleSheetData();};const handleStartSubmit=()=>{localStorage.removeItem('gameState');onStartGameSubmit();};const handleResumeSubmit=()=>{onStartGameSubmit();};return/*#__PURE__*/_jsxs(\"div\",{className:\"background-grid home-page center-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"center-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:config.home.title}),/*#__PURE__*/_jsx(\"h3\",{children:config.home.subTitle}),/*#__PURE__*/_jsx(\"div\",{className:\"ui-card ui-button-container\",children:/*#__PURE__*/_jsx(Link,{onClick:handleStartSubmit,to:\"/tri-cartes/game\",className:\"button button-normal\",children:config.home.buttonStart})}),localStorageDetected&&/*#__PURE__*/ // Affichage conditionnel du bouton de reprise\n_jsx(Link,{onClick:handleResumeSubmit,to:\"/tri-cartes/game\",className:\"button button-small\",children:config.home.buttonResume})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"option-menu ui-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\".concat(config.home.titleUpdateList)}),/*#__PURE__*/_jsx(\"div\",{children:\"(\".concat(config.home.subTitleUpdateList,\")\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"row-content\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input-field\",type:\"text\",value:googleSheetURL,onChange:handleURLChange,placeholder:\"Enter Google Sheet URL\"}),/*#__PURE__*/_jsx(\"div\",{onClick:handleSubmit,className:\"button button-small\",children:config.home.buttonUpdateList})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[extractionCount!==null&&/*#__PURE__*/_jsx(\"div\",{className:\"ui-card info-box success\",children:\"\".concat(extractionCount,\" \").concat(config.home.infoUpdateList)}),errorMessages.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"ui-card info-box error\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"error-list\",children:errorMessages.map((errorMessage,index)=>/*#__PURE__*/_jsx(\"li\",{children:errorMessage},index))})})]})]});};export default HomePage;","map":{"version":3,"names":["React","useState","useEffect","Link","axios","Papa","config","jsx","_jsx","jsxs","_jsxs","HomePage","_ref","onGoogleSheetSubmit","onStartGameSubmit","googleSheetURL","setGoogleSheetURL","home","baseURL","extractionCount","setExtractionCount","errorMessages","setErrorMessages","localStorageDetected","setLocalStorageDetected","isLocalStorageDetected","localStorage","getItem","fetchGoogleSheetData","handleURLChange","event","target","value","response","get","csvData","data","parse","header","dynamicTyping","complete","result","activeJobs","filter","row","ACTIF","formattedData","map","text","MÉTIER","description","DESCRIPTION","length","error","console","message","concat","handleSubmit","handleStartSubmit","removeItem","handleResumeSubmit","className","children","title","subTitle","onClick","to","buttonStart","buttonResume","titleUpdateList","subTitleUpdateList","type","onChange","placeholder","buttonUpdateList","infoUpdateList","errorMessage","index"],"sources":["/Users/todmopel/TheHangar/lesCentMétiers/tri-cartes/src/pages/HomePage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport Papa from 'papaparse';\nimport './../App.css';\n\nimport config from './../data/config';\n\nconst HomePage = ({ onGoogleSheetSubmit, onStartGameSubmit }) => {\n    const [googleSheetURL, setGoogleSheetURL] = useState(config.home.baseURL);\n    const [extractionCount, setExtractionCount] = useState(null);\n    const [errorMessages, setErrorMessages] = useState([]);\n    const [localStorageDetected, setLocalStorageDetected] = useState(false);\n\n    useEffect(() => {\n        const isLocalStorageDetected = localStorage.getItem('gameState');\n        setLocalStorageDetected(!!isLocalStorageDetected);\n\n        fetchGoogleSheetData();\n    }, []);\n\n    const handleURLChange = (event) => {\n        setGoogleSheetURL(event.target.value);\n    };\n\n    useEffect(() => {\n        fetchGoogleSheetData();\n    }, []);\n\n    const fetchGoogleSheetData = async () => {\n        try {\n            const response = await axios.get(googleSheetURL);\n            const csvData = response.data;\n\n            Papa.parse(csvData, {\n                header: true,\n                dynamicTyping: true,\n                complete: (result) => {\n                    const activeJobs = result.data.filter((row) => row.ACTIF === true);\n\n                    const formattedData = activeJobs.map((row) => ({\n                        text: row.MÉTIER,\n                        description: row.DESCRIPTION,\n                    }));\n\n                    setExtractionCount(activeJobs.length);\n                    setErrorMessages([]);\n                    onGoogleSheetSubmit(formattedData);\n                },\n                error: (error) => {\n                    console.error('Erreur lors de l\\'analyse CSV :', error);\n                    setExtractionCount(null);\n                    setErrorMessages([error.message]);\n                },\n            });\n        } catch (error) {\n            console.error('Erreur lors de la récupération des données du Google Sheet :', error);\n            setExtractionCount(null);\n            setErrorMessages([`Erreur lors de la récupération des données du Google Sheet:\\n ${error}`]);\n        }\n    };\n\n    const handleSubmit = () => {\n        setExtractionCount(null);\n        fetchGoogleSheetData();\n    };\n\n    const handleStartSubmit = () => {\n        localStorage.removeItem('gameState');\n        onStartGameSubmit();\n    };\n\n    const handleResumeSubmit = () => {\n        onStartGameSubmit();\n    };\n\n    return (\n        <div className=\"background-grid home-page center-content\">\n            <div className=\"center-content\">\n                <h1>{config.home.title}</h1>\n                <h3>{config.home.subTitle}</h3>\n                <div className=\"ui-card ui-button-container\">\n                    <Link\n                    \n                        onClick={handleStartSubmit}\n                        to=\"/tri-cartes/game\"\n                        className=\"button button-normal\"\n                    >\n                        {config.home.buttonStart}\n                    </Link>\n                </div>\n\n                {localStorageDetected && ( // Affichage conditionnel du bouton de reprise\n                    <Link\n                        onClick={handleResumeSubmit}\n                        to=\"/tri-cartes/game\"\n                        className=\"button button-small\"\n                    >\n                        {config.home.buttonResume}\n                    </Link>\n                )}\n            </div>\n            <div className=\"option-menu ui-card\">\n                <h2>{`${config.home.titleUpdateList}`}</h2>\n                <div>{`(${config.home.subTitleUpdateList})`}</div>\n                <div className=\"row-content\">\n                    <input\n                        className=\"input-field\"\n                        type=\"text\"\n                        value={googleSheetURL}\n                        onChange={handleURLChange}\n                        placeholder=\"Enter Google Sheet URL\"\n                    />\n                    <div onClick={handleSubmit} className=\"button button-small\">\n                        {config.home.buttonUpdateList}\n                    </div>\n                </div>\n            </div>\n            <div>\n            {extractionCount !== null && (\n                <div className={`ui-card info-box success`}>\n                    {`${extractionCount} ${config.home.infoUpdateList}`}\n                </div>\n            )}\n            {errorMessages.length > 0 && (\n                <div className={`ui-card info-box error`}>\n                    <ul className=\"error-list\">\n                        {errorMessages.map((errorMessage, index) => (\n                            <li key={index}>{errorMessage}</li>\n                        ))}\n                    </ul>\n                </div>\n            )}\n            </div>\n        </div>\n    );\n};\n\nexport default HomePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}